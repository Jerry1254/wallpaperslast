(()=>{var e={};e.id=5788,e.ids=[5788],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},41790:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page-experimental.runtime.prod.js")},71017:e=>{"use strict";e.exports=require("path")},50318:(e,a,s)=>{"use strict";s.r(a),s.d(a,{GlobalError:()=>i.a,__next_app__:()=>h,originalPathname:()=>p,pages:()=>d,routeModule:()=>u,tree:()=>c});var t=s(67096),r=s(16132),l=s(37284),i=s.n(l),n=s(32564),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(a,o);let c=["",{children:["wallpapers",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,45852)),"/Users/kele/Desktop/aicode/wallpaper-admin-last/app/wallpapers/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,35345)),"/Users/kele/Desktop/aicode/wallpaper-admin-last/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/kele/Desktop/aicode/wallpaper-admin-last/app/wallpapers/page.tsx"],p="/wallpapers/page",h={require:s,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/wallpapers/page",pathname:"/wallpapers",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},34990:(e,a,s)=>{Promise.resolve().then(s.bind(s,31158))},31158:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>WallpapersPage});var t=s(30784),r=s(9885),l=s(57230),i=s(26303),n=s(52451),o=s.n(n),c=s(95555),d=s(13422),p=s(12025),h=s(47917),u=s(95248),m=s(40516),x=s(33770),f=s(32451),j=s(45086),g=s(81915),v=s(98699);let y=r.forwardRef(({className:e,value:a,...s},r)=>t.jsx(g.fC,{ref:r,className:(0,v.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...s,children:t.jsx(g.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));y.displayName=g.fC.displayName;var w=s(6315);function FileUploader({onUpload:e,maxSize:a=100,accept:s}){let[l,i]=(0,r.useState)({}),createThumbnail=async e=>e.type.startsWith("video/")?new Promise(a=>{let s=document.createElement("video");s.preload="metadata",s.src=URL.createObjectURL(e),s.currentTime=1,s.onloadeddata=()=>{let e=document.createElement("canvas");e.width=s.videoWidth,e.height=s.videoHeight;let t=e.getContext("2d");t?.drawImage(s,0,0,e.width,e.height);let r=e.toDataURL("image/jpeg");URL.revokeObjectURL(s.src),a(r)},s.onerror=()=>{URL.revokeObjectURL(s.src),a("")}}):"",uploadFile=async a=>{let s=Math.random().toString(36).substring(7);console.log("Starting upload for file:",{id:s,name:a.name,type:a.type,size:a.size}),i(e=>({...e,[s]:{id:s,name:a.name,progress:0,status:"uploading"}}));try{console.log("Creating thumbnail for:",a.name);let t="";a.type.startsWith("video/")&&(t=await createThumbnail(a)),console.log("Thumbnail created:",t?"success":"not needed");let r=new FormData;r.append("file",a),console.log("FormData created with file"),console.log("Sending upload request");let l=await fetch("/api/upload",{method:"POST",body:r});console.log("Upload response status:",l.status);let n=await l.json();if(console.log("Upload response data:",n),!l.ok)throw Error(n.error||"上传失败");let{url:o}=n;console.log("File uploaded successfully:",o),i(e=>({...e,[s]:{...e[s],progress:100,status:"success"}}));let c={id:s,name:a.name,url:o,type:a.type,...t&&{thumbnail:t}};console.log("Sending file data to parent:",c),e(c),setTimeout(()=>{i(e=>{let{[s]:a,...t}=e;return t})},1e3)}catch(e){console.error("Upload error for file:",a.name,e),i(a=>({...a,[s]:{...a[s],status:"error",error:e.message||"上传失败"}})),(0,p.Am)({variant:"destructive",description:`上传失败: ${e.message||"未知错误"}`})}},n=(0,r.useCallback)(async(e,s)=>{for(let t of(s.forEach(({file:e,errors:s})=>{let t=s.map(e=>"file-too-large"===e.code?`文件大小超过 ${a}MB`:"file-invalid-type"===e.code?"不支持的文件类型":e.message);(0,p.Am)({variant:"destructive",description:`${e.name}: ${t.join(", ")}`})}),e))await uploadFile(t)},[a,e]),{getRootProps:o,getInputProps:d,isDragActive:h}=(0,j.uI)({onDrop:n,maxSize:1048576*a,accept:s});return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{...o(),className:`
          border-2 border-dashed rounded-lg p-6
          flex flex-col items-center justify-center
          cursor-pointer
          transition-colors
          ${h?"border-primary bg-primary/10":"border-border"}
        `,children:[t.jsx("input",{...d()}),t.jsx(w.Z,{className:"w-10 h-10 mb-2 text-muted-foreground"}),(0,t.jsxs)("div",{className:"text-center space-y-1",children:[(0,t.jsxs)("p",{className:"text-sm",children:["拖拽文件到此处，或",t.jsx(c.z,{type:"button",variant:"link",className:"px-1",children:"点击上传"})]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["支持的文件类型：图片 (PNG, JPG, GIF) 和视频 (MP4, WebM)",t.jsx("br",{}),"单个文件最大 ",a,"MB"]})]})]}),Object.values(l).length>0&&t.jsx("div",{className:"space-y-2",children:Object.values(l).map(e=>(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"truncate flex-1",children:e.name}),(0,t.jsxs)("span",{className:"ml-2",children:["uploading"===e.status&&`${e.progress}%`,"error"===e.status&&"上传失败","success"===e.status&&"上传完成"]})]}),"uploading"===e.status&&t.jsx(y,{value:e.progress,className:"h-1"}),e.error&&t.jsx("p",{className:"text-xs text-red-500",children:e.error})]},e.id))})]})}var b=s(14723);function AddShopModal({open:e,onOpenChange:a,onSuccess:s}){let[l,i]=(0,r.useState)(!1),[n,o]=(0,r.useState)(""),[d,h]=(0,r.useState)(""),handleSubmit=async e=>{if(e.preventDefault(),h(""),!n.trim()){h("店铺名称不能为空");return}i(!0);try{let e=await fetch("/api/shops",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n.trim()})}),t=await e.json();if(!e.ok)throw Error(t.error||"创建店铺失败");(0,p.Am)({description:"店铺创建成功！"}),a(!1),s?.(),o("")}catch(e){h(e.message||"创建店铺失败，请重试")}finally{i(!1)}};return t.jsx(m.Vq,{open:e,onOpenChange:a,children:(0,t.jsxs)(m.cZ,{className:"sm:max-w-[425px]",children:[t.jsx(m.fK,{children:t.jsx(m.$N,{children:"新增店铺"})}),(0,t.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(f._,{htmlFor:"name",children:"店铺名称"}),t.jsx(x.I,{id:"name",value:n,onChange:e=>o(e.target.value),placeholder:"请输入店铺名称"}),d&&t.jsx("p",{className:"text-sm text-red-500",children:d})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2",children:[t.jsx(c.z,{variant:"outline",type:"button",onClick:()=>a(!1),children:"取消"}),t.jsx(c.z,{type:"submit",disabled:l,children:l?"创建中...":"确定"})]})]})]})})}var N=s(99098),S=s(71017),C=s.n(S);function UploadWallpaperModal({open:e,onOpenChange:a,initialData:s,mode:l="create",onSuccess:n}){let[o,d]=(0,r.useState)([]),[h,u]=(0,r.useState)(""),[j,g]=(0,r.useState)(""),[v,y]=(0,r.useState)([]),[w,S]=(0,r.useState)(!1),[k,P]=(0,r.useState)({}),[_,A]=(0,r.useState)(null),[E,z]=(0,r.useState)(!1);(0,r.useEffect)(()=>{e&&(fetchShops(),"edit"===l&&s?(u(s.name),g(s.shopId),d(s.files.map(e=>({...e,name:e.name||e.url.split("/").pop()||"未命名文件"})))):(u(""),g(""),d([]),P({})))},[e,l,s]);let fetchShops=async()=>{try{let e=await fetch("/api/shops");if(!e.ok)throw Error("Failed to fetch shops");let a=await e.json();if(0===a.code)y(a.data);else throw Error(a.message||"Failed to fetch shops")}catch(e){console.error("Fetch shops error:",e),(0,p.Am)({variant:"destructive",description:"获取店铺列表失败"})}},validateForm=()=>{let e={},a=!0;return h.trim()||(e.name="请输入壁纸名称",a=!1),j||(e.shopId="请选择店铺",a=!1),0===o.length&&(e.files="请上传至少一个文件",a=!1),P(e),a},handleUpload=async()=>{if(validateForm()){z(!0);try{let e="edit"===l&&s?.id?`/api/wallpapers/${s.id}`:"/api/wallpapers",t="edit"===l?"PUT":"POST",r=await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify({name:h,shopId:j,files:o.map(e=>({url:e.url,type:e.type,name:e.name,thumbnail:e.thumbnail}))})}),i=await r.json();if(!r.ok)throw Error(i.error||"操作失败");(0,p.Am)({description:"create"===l?"上传成功！":"更新成功！"}),a(!1),d([]),u(""),g(""),P({}),n?.()}catch(e){console.error("Upload error:",e),(0,p.Am)({variant:"destructive",description:e.message||"操作失败，请重试"})}finally{z(!1)}}},handleFileDelete=async e=>{let a=o.find(a=>a.id===e);if(a)try{let s=a.url.startsWith("/")?a.url.slice(1):a.url;C().join(process.cwd(),"public",s),await fetch("/api/upload/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:s})}),d(o.filter(a=>a.id!==e)),_===e&&A(null),o.length<=1&&P(e=>({...e,files:"请上传至少一个文件"}))}catch(e){console.error("Delete file error:",e),(0,p.Am)({variant:"destructive",description:"删除文件失败"})}},U=(0,r.useCallback)(()=>{fetchShops()},[]);return(0,t.jsxs)(t.Fragment,{children:[t.jsx(m.Vq,{open:e,onOpenChange:a,children:(0,t.jsxs)(m.cZ,{className:"max-w-3xl max-h-[85vh] overflow-hidden flex flex-col",children:[t.jsx(m.fK,{children:t.jsx(m.$N,{children:"create"===l?"新增壁纸":"编辑壁纸"})}),t.jsx("div",{className:"flex-1 overflow-y-auto px-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(f._,{htmlFor:"name",children:"壁纸名称"}),t.jsx(x.I,{id:"name",value:h,onChange:e=>{u(e.target.value),e.target.value.trim()&&P(e=>({...e,name:void 0}))},placeholder:"请输入壁纸名称"}),k.name&&t.jsx("p",{className:"text-sm text-red-500",children:k.name})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(f._,{children:"选择店铺"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(b.Ph,{value:j,onValueChange:e=>{g(e),P(e=>({...e,shopId:void 0}))},children:[t.jsx(b.i4,{className:"flex-1",children:t.jsx(b.ki,{placeholder:"请选择店铺"})}),t.jsx(b.Bw,{children:v.map(e=>t.jsx(b.Ql,{value:e.id,children:e.name},e.id))})]}),t.jsx(AddShopModal,{open:w,onOpenChange:S,onSuccess:U}),t.jsx(c.z,{variant:"outline",onClick:()=>S(!0),children:"新增店铺"})]}),k.shopId&&t.jsx("p",{className:"text-sm text-red-500",children:k.shopId})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(f._,{children:"上传文件"}),t.jsx(FileUploader,{onUpload:e=>{e.type.startsWith("video/");let a=e.name||e.url.split("/").pop()||"未命名文件";d(s=>[...s,{...e,name:a,thumbnail:e.url}]),P(e=>({...e,files:void 0}))},maxSize:100,accept:{"image/*":[".png",".jpg",".jpeg",".gif"],"video/*":[".mp4",".webm"]}}),k.files&&t.jsx("p",{className:"text-sm text-red-500",children:k.files})]}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:o.map(e=>(0,t.jsxs)("div",{className:"relative group",children:[e.type.startsWith("video/")?t.jsx("div",{className:"relative aspect-[9/16] bg-gray-100 rounded-lg overflow-hidden group",children:t.jsx(N.F,{src:e.url,className:"w-full h-full object-cover",onPlay:()=>A(e.id)})}):t.jsx("div",{className:"relative aspect-[9/16] bg-gray-100 rounded-lg overflow-hidden",children:t.jsx("img",{src:e.url,alt:e.name,className:"w-full h-full object-cover"})}),(0,t.jsxs)("div",{className:"mt-1 flex items-center justify-between",children:[t.jsx("p",{className:"text-sm truncate flex-1",children:e.name}),t.jsx(c.z,{variant:"ghost",size:"icon",className:"opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>handleFileDelete(e.id),children:t.jsx(i.Z,{className:"h-4 w-4"})})]})]},e.id))})]})}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 py-4 px-6 border-t mt-4",children:[t.jsx(c.z,{variant:"outline",onClick:()=>a(!1),disabled:E,children:"取消"}),t.jsx(c.z,{onClick:handleUpload,disabled:E,loading:E,children:"create"===l?"上传":"更新"})]})]})}),t.jsx(AddShopModal,{open:w,onOpenChange:S,onSuccess:U})]})}var k=s(66386),P=s(34010),_=s(85574),A=s(51910),E=s(11922),z=s(24874);function WallpaperList({searchQuery:e,shopId:a}){let[s,l]=(0,r.useState)([]),[n,m]=(0,r.useState)(1),[x,f]=(0,r.useState)(0),[j,g]=(0,r.useState)(!1),[v,y]=(0,r.useState)(null),[w,b]=(0,r.useState)(!1),[S,C]=(0,r.useState)(null),[U,F]=(0,r.useState)(!0),[O,D]=(0,r.useState)([]),[T,W]=(0,r.useState)(!1),[$,I]=(0,r.useState)(0),M=Math.ceil(x/20),fetchWallpapers=async()=>{try{let s;F(!0);let t=new URLSearchParams;e&&t.append("search",e),a&&t.append("shopId",String(a)),t.append("page",String(n)),t.append("pageSize",String(20));let r=`/api/wallpapers?${t.toString()}`;console.log("Fetching URL:",r);let i=await fetch(r);console.log("Response status:",i.status),console.log("Response headers:",Object.fromEntries(i.headers.entries()));let o=await i.text();console.log("Raw response:",o);try{s=JSON.parse(o),console.log("Parsed response:",s)}catch(e){throw console.error("Failed to parse response as JSON:",e),Error("API 响应格式错误")}if(i.ok){if(!Array.isArray(s.data.list))throw console.error("Unexpected API response format:",s),Error("API 返回数据格式错误");l(s.data.list),f(s.data.pagination.total)}else throw console.error("API Error:",{status:i.status,statusText:i.statusText,data:s}),Error(s.error||s.details||"获取壁纸列表失败")}catch(e){console.error("Fetch wallpapers error:",e),e instanceof Error&&console.error("Full error details:",{name:e.name,message:e.message,stack:e.stack,cause:e.cause}),(0,p.Am)({variant:"destructive",description:e instanceof Error?e.message:"获取壁纸列表失败"}),l([])}finally{F(!1)}},handleDelete=async()=>{if(v)try{let e=await fetch(`/api/wallpapers/${v}`,{method:"DELETE"});if(e.ok)(0,p.Am)({description:"壁纸已删除"}),m(1),await fetchWallpapers();else{let a=await e.json();(0,p.Am)({variant:"destructive",description:a.error||"删除失败"})}}catch(e){console.error("Delete error:",e),(0,p.Am)({variant:"destructive",description:"删除失败"})}finally{g(!1),y(null)}},handleEdit=e=>{C(e),b(!0)},R=(0,r.useCallback)(async e=>{try{let a=await fetch("/api/settings"),s=await a.json(),t=s.data?.share_button_text||"点击下载",r=`${window.location.origin}/share/${e.id}`,l=`${t} ${r}`;await navigator.clipboard.writeText(l),(0,p.Am)({description:"分享链接已复制到剪贴板"})}catch(e){(0,p.Am)({variant:"destructive",description:"复制分享链接失败"})}},[p.Am]),handlePageChange=e=>{m(e)};return(0,r.useEffect)(()=>{m(1),fetchWallpapers()},[e,a]),(0,r.useEffect)(()=>{fetchWallpapers()},[n]),(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx("div",{className:"rounded-md border",children:(0,t.jsxs)(d.iA,{children:[t.jsx(d.xD,{children:(0,t.jsxs)(d.SC,{children:[t.jsx(d.ss,{children:"缩略图"}),t.jsx(d.ss,{children:"名称"}),t.jsx(d.ss,{children:"店铺"}),t.jsx(d.ss,{children:"图片数量"}),t.jsx(d.ss,{children:"创建时间"}),t.jsx(d.ss,{className:"text-right",children:"操作"})]})}),t.jsx(d.RM,{children:s.map(e=>{let a=e.files[0],s=a.type.startsWith("video/");return(0,t.jsxs)(d.SC,{children:[t.jsx(d.pj,{children:t.jsx("div",{className:"relative h-[200px] w-[112.5px] cursor-pointer",onClick:()=>{D(e.files.map(e=>({url:e.url,type:e.type}))),I(0),W(!0)},children:s?t.jsx(N.F,{src:a.url,className:"w-full h-full object-cover rounded-lg"}):t.jsx(o(),{src:a.url,alt:e.name,fill:!0,className:"object-cover rounded-lg"})})}),t.jsx(d.pj,{children:e.name}),t.jsx(d.pj,{children:e.shop_name}),t.jsx(d.pj,{children:e.image_count}),t.jsx(d.pj,{children:new Date(e.created_at).toLocaleString()}),t.jsx(d.pj,{className:"text-right",children:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[t.jsx(c.z,{variant:"outline",size:"icon",onClick:()=>R(e),children:t.jsx(k.Z,{className:"h-4 w-4"})}),t.jsx(c.z,{variant:"outline",size:"icon",onClick:()=>handleEdit(e),children:t.jsx(P.Z,{className:"h-4 w-4"})}),t.jsx(c.z,{variant:"outline",size:"icon",onClick:()=>{if(!Array.isArray(e.files)||0===e.files.length){(0,p.Am)({variant:"destructive",description:"没有可下载的文件"});return}e.files.forEach((e,a)=>{let s=document.createElement("a");s.href=e.url,s.download=e.name,document.body.appendChild(s),setTimeout(()=>{s.click(),document.body.removeChild(s)},500*a)}),(0,p.Am)({description:`开始下载 ${e.files.length} 个文件`})},children:t.jsx(_.Z,{className:"h-4 w-4"})}),t.jsx(c.z,{variant:"outline",size:"icon",onClick:()=>{y(e.id),g(!0)},children:t.jsx(i.Z,{className:"h-4 w-4"})})]})})]},e.id)})})]})}),x>0&&t.jsx("div",{className:"flex justify-center mt-4",children:t.jsx(h.tl,{children:(0,t.jsxs)(h.ng,{children:[t.jsx(h.nt,{children:(0,t.jsxs)(c.z,{variant:"outline",onClick:e=>{e.preventDefault(),n>1&&handlePageChange(n-1)},disabled:1===n,className:"gap-1",children:[t.jsx(A.Z,{className:"h-4 w-4"}),"上一页"]})}),Array.from({length:Math.max(1,M)},(e,a)=>a+1).map(e=>t.jsx(h.nt,{children:t.jsx(h.kN,{href:"#",onClick:a=>{a.preventDefault(),handlePageChange(e)},isActive:e===n,children:e})},e)),t.jsx(h.nt,{children:(0,t.jsxs)(c.z,{variant:"outline",onClick:e=>{e.preventDefault(),n<M&&handlePageChange(n+1)},disabled:n>=M,className:"gap-1",children:["下一页",t.jsx(E.Z,{className:"h-4 w-4"})]})})]})})}),t.jsx(u.Q,{open:j,onOpenChange:g,title:"删除壁纸",description:"确定要删除这个壁纸吗？此操作不可恢复。",onConfirm:()=>v&&handleDelete()}),t.jsx(UploadWallpaperModal,{open:w,onOpenChange:b,mode:"edit",initialData:S||void 0,onSuccess:()=>{b(!1),C(null),fetchWallpapers()}}),t.jsx(z.e,{images:O,initialIndex:$,open:T,onOpenChange:W})]})}var U=s(1150);let F=U.fC,O=r.forwardRef(({className:e,...a},s)=>t.jsx(U.aV,{ref:s,className:(0,v.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...a}));O.displayName=U.aV.displayName;let D=r.forwardRef(({className:e,...a},s)=>t.jsx(U.xz,{ref:s,className:(0,v.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...a}));D.displayName=U.xz.displayName;let T=r.forwardRef(({className:e,...a},s)=>t.jsx(U.VY,{ref:s,className:(0,v.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...a}));function WallpapersPage(){let[e,a]=(0,r.useState)(!1),[s,i]=(0,r.useState)(0),[n,o]=(0,r.useState)(""),[d,h]=(0,r.useState)("all"),[u,m]=(0,r.useState)([]),{toast:f}=(0,p.pm)();(0,r.useEffect)(()=>{fetchShops()},[]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{i(e=>e+1)},300);return()=>clearTimeout(e)},[n]);let fetchShops=async()=>{try{let e=await fetch("/api/shops"),a=await e.json();if(0===a.code)m(a.data);else throw Error(a.message||"获取店铺列表失败")}catch(e){f({variant:"destructive",description:"获取店铺列表失败"})}},j=(0,r.useCallback)(()=>{i(e=>e+1)},[]);return t.jsx(l.AdminLayout,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[t.jsx(x.I,{placeholder:"搜索壁纸...",value:n,onChange:e=>o(e.target.value),className:"max-w-sm"}),t.jsx(F,{value:d,onValueChange:e=>{h(e),i(e=>e+1)},className:"flex-1",children:(0,t.jsxs)(O,{children:[t.jsx(D,{value:"all",children:"全部"}),u.map(e=>t.jsx(D,{value:String(e.id),children:e.name},e.id))]})})]}),t.jsx(c.z,{onClick:()=>a(!0),children:"新增壁纸"})]}),t.jsx(WallpaperList,{searchQuery:n,shopId:"all"===d?void 0:Number(d)},s),t.jsx(UploadWallpaperModal,{open:e,onOpenChange:a,onSuccess:j})]})})}T.displayName=U.VY.displayName},45852:(e,a,s)=>{"use strict";s.r(a),s.d(a,{$$typeof:()=>i,__esModule:()=>l,default:()=>o});var t=s(95153);let r=(0,t.createProxy)(String.raw`/Users/kele/Desktop/aicode/wallpaper-admin-last/app/wallpapers/page.tsx`),{__esModule:l,$$typeof:i}=r,n=r.default,o=n}};var a=require("../../webpack-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),s=a.X(0,[6214,6426,3979,968,3157,2451,1388,9071,4894,456,3124,5601,3086,4333,5555,2025,7230,516,9098,6842,4874,6092],()=>__webpack_exec__(50318));module.exports=s})();