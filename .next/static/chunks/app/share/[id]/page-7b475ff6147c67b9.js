(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[790],{81291:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(65531);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},82549:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(65531);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5283:function(e,t,n){Promise.resolve().then(n.bind(n,39922))},39922:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return SharePage}});var a=n(26705),r=n(20955),s=n(16691),o=n.n(s),i=n(23611),l=n(71271),d=n(35817),c=n(17123),u=n(17410),f=n(17775);function SharePage(e){let{params:t}=e,[n,s]=(0,r.useState)(null),[p,m]=(0,r.useState)(!0),[h,g]=(0,r.useState)(null),[x,v]=(0,r.useState)(!1),[y,b]=(0,r.useState)(0),{toast:j}=(0,l.pm)();(0,r.useEffect)(()=>{fetchSharePage()},[]);let fetchSharePage=async()=>{try{m(!0),g(null);let e=await fetch("/api/share?id=".concat(t.id)),n=await e.json();0===n.code?s(n.data):(g(n.message||"获取分享页失败"),j({variant:"destructive",description:n.message||"获取分享页失败"}))}catch(e){console.error("Error fetching share page:",e),g("获取分享页失败"),j({variant:"destructive",description:"获取分享页失败"})}finally{m(!1)}},handleDownloadSingle=e=>{let t=document.createElement("a");t.href=e.url,t.download=e.name,document.body.appendChild(t),t.click(),document.body.removeChild(t)};return p?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"text-center",children:"加载中..."})}):h?(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"text-center text-red-500",children:h})}):n?(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:n.wallpaperName}),(0,a.jsx)("div",{className:"mb-6",children:(0,f.ZP)(n.description)}),(0,a.jsxs)(i.z,{className:"mb-8 w-full",size:"lg",onClick:()=>{(null==n?void 0:n.files)&&(n.files.forEach((e,t)=>{let n=document.createElement("a");n.href=e.url,n.download=e.name,document.body.appendChild(n),setTimeout(()=>{n.click(),document.body.removeChild(n)},500*t)}),j({description:"开始下载 ".concat(n.files.length," 个文件")}))},children:[(0,a.jsx)(d.Z,{className:"mr-2 h-5 w-5"}),"下载全部"]}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-4",children:n.files.map((e,t)=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"relative aspect-[9/16] w-full overflow-hidden rounded-lg cursor-pointer",onClick:()=>{b(t),v(!0)},children:"video/mp4"===e.type?(0,a.jsx)(c.F,{src:e.url,className:"h-full w-full object-cover"}):(0,a.jsx)(o(),{src:e.url,alt:e.name,fill:!0,className:"object-cover"})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-sm truncate",children:e.name}),(0,a.jsx)(i.z,{variant:"outline",className:"w-full",onClick:()=>handleDownloadSingle(e),children:n.buttonText||"点击下载单张壁纸"})]})]},e.id))}),(0,a.jsx)(u.e,{images:(null==n?void 0:n.files.map(e=>({url:e.url,type:e.type})))||[],initialIndex:y,open:x,onOpenChange:v})]}):(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"text-center",children:"分享页不存在"})})}},17410:function(e,t,n){"use strict";n.d(t,{e:function(){return ImagePreviewModal}});var a=n(26705),r=n(20955),s=n(62031),o=n(82549),i=n(81291),l=n(17158),d=n(23611),c=n(17123);function ImagePreviewModal(e){var t;let{images:n,initialIndex:u=0,open:f,onOpenChange:p}=e,[m,h]=(0,r.useState)(u);(0,r.useEffect)(()=>{m>=n.length&&h(0)},[m,n.length]),(0,r.useEffect)(()=>{h(u)},[u]);let g=n[m],x=null==g?void 0:null===(t=g.type)||void 0===t?void 0:t.startsWith("video/"),v=(0,r.useCallback)(()=>{h(e=>0===e?n.length-1:e-1)},[n.length]),y=(0,r.useCallback)(()=>{h(e=>e===n.length-1?0:e+1)},[n.length]),b=(0,r.useCallback)(e=>{"ArrowLeft"===e.key?v():"ArrowRight"===e.key?y():"Escape"===e.key&&p(!1)},[v,y,p]);return((0,r.useEffect)(()=>{if(f)return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[f,b]),n.length&&g)?(0,a.jsx)(s.Vq,{open:f,onOpenChange:p,children:(0,a.jsx)(s.cZ,{className:"max-w-full h-[90vh] p-0 border-none bg-black/90",children:(0,a.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center",children:[(0,a.jsx)(d.z,{variant:"ghost",size:"icon",className:"absolute top-4 right-4 z-50 text-white hover:bg-white/20",onClick:()=>p(!1),children:(0,a.jsx)(o.Z,{className:"h-6 w-6"})}),n.length>1&&(0,a.jsx)(d.z,{variant:"ghost",size:"icon",className:"absolute left-4 z-50 text-white hover:bg-white/20",onClick:v,children:(0,a.jsx)(i.Z,{className:"h-8 w-8"})}),(0,a.jsx)("div",{className:"w-auto h-full flex items-center justify-center p-4",children:(0,a.jsx)("div",{className:"relative h-[80vh]",style:{aspectRatio:"9/16",maxHeight:"80vh"},children:x?(0,a.jsx)(c.F,{src:g.url,className:"h-full w-full object-contain"}):(0,a.jsx)("img",{src:g.url,alt:"",className:"h-full w-full object-contain"})})}),n.length>1&&(0,a.jsx)(d.z,{variant:"ghost",size:"icon",className:"absolute right-4 z-50 text-white hover:bg-white/20",onClick:y,children:(0,a.jsx)(l.Z,{className:"h-8 w-8"})}),n.length>1&&(0,a.jsxs)("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white bg-black/50 px-3 py-1 rounded-full",children:[m+1," / ",n.length]})]})})}):null}},23611:function(e,t,n){"use strict";n.d(t,{d:function(){return d},z:function(){return c}});var a=n(26705),r=n(20955),s=n(67256),o=n(96061),i=n(81628),l=n(63715);let d=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:n,variant:r,size:o,asChild:c=!1,loading:u=!1,children:f,disabled:p,...m}=e,h=c?s.g7:"button";return(0,a.jsx)(h,{className:(0,i.cn)(d({variant:r,size:o,className:n})),ref:t,disabled:u||p,...m,children:u?(0,a.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4 animate-spin"}),f]}):f})});c.displayName="Button"},62031:function(e,t,n){"use strict";n.d(t,{$N:function(){return f},Vq:function(){return l},cZ:function(){return u},fK:function(){return DialogHeader}});var a=n(26705),r=n(20955),s=n(28712),o=n(82549),i=n(81628);let l=s.fC;s.xz;let d=s.h_;s.x8;let c=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)(s.aV,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...r})});c.displayName=s.aV.displayName;let u=r.forwardRef((e,t)=>{let{className:n,children:r,...l}=e;return(0,a.jsxs)(d,{children:[(0,a.jsx)(c,{}),(0,a.jsxs)(s.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n),...l,children:[r,(0,a.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=s.VY.displayName;let DialogHeader=e=>{let{className:t,...n}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...n})};DialogHeader.displayName="DialogHeader";let f=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)(s.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",n),...r})});f.displayName=s.Dx.displayName;let p=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)(s.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",n),...r})});p.displayName=s.dk.displayName},71271:function(e,t,n){"use strict";n.d(t,{Am:function(){return toast},pm:function(){return useToast}});var a=n(20955);let r=0,s=new Map,addToRemoveQueue=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),dispatch({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},reducer=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:n}=t;return n?addToRemoveQueue(n):e.toasts.forEach(e=>{addToRemoveQueue(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===n||void 0===n?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],i={toasts:[]};function dispatch(e){i=reducer(i,e),o.forEach(e=>{e(i)})}function toast(e){let{...t}=e,n=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),dismiss=()=>dispatch({type:"DISMISS_TOAST",toastId:n});return dispatch({type:"ADD_TOAST",toast:{...t,id:n,open:!0,onOpenChange:e=>{e||dismiss()}}}),{id:n,dismiss,update:e=>dispatch({type:"UPDATE_TOAST",toast:{...e,id:n}})}}function useToast(){let[e,t]=a.useState(i);return a.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast,dismiss:e=>dispatch({type:"DISMISS_TOAST",toastId:e})}}},17123:function(e,t,n){"use strict";n.d(t,{F:function(){return VideoPreview}});var a=n(26705),r=n(20955),s=n(99848);function VideoPreview(e){let{src:t,className:n,onPlay:o}=e,i=(0,r.useRef)(null),[l,d]=(0,r.useState)(!0),[c,u]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e=i.current;if(!e)return;let handleLoadedData=()=>{e.currentTime=.1,u(!0)};return e.addEventListener("loadeddata",handleLoadedData),()=>{e.removeEventListener("loadeddata",handleLoadedData)}},[t]),(0,a.jsxs)("div",{className:"relative w-full h-full",children:[(0,a.jsx)("video",{ref:i,src:t,className:"".concat(n," rounded-lg"),controls:!l}),l&&(0,a.jsx)("button",{onClick:()=>{if(l&&c){var e;null===(e=i.current)||void 0===e||e.play(),d(!1),null==o||o()}},className:"absolute inset-0 flex items-center justify-center bg-black/30 transition-opacity opacity-0 group-hover:opacity-100",children:(0,a.jsx)(s.Z,{className:"w-12 h-12 text-white"})})]})}},81628:function(e,t,n){"use strict";n.d(t,{cn:function(){return cn}});var a=n(57042),r=n(74769);function cn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m6)((0,a.W)(t))}},28712:function(e,t,n){"use strict";n.d(t,{Dx:function(){return K},VY:function(){return Y},aV:function(){return X},dk:function(){return G},fC:function(){return q},h_:function(){return U},jm:function(){return $},p8:function(){return j},x8:function(){return J},xz:function(){return Q}});var a=n(20955),r=n(85744),s=n(42210),o=n(56989),i=n(20966),l=n(73763),d=n(79249),c=n(52759),u=n(52730),f=n(85606),p=n(9381),m=n(31244),h=n(17552),g=n(85859),x=n(67256),v=n(26705),y="Dialog",[b,j]=(0,o.b)(y),[w,N]=b(y),Dialog=e=>{let{__scopeDialog:t,children:n,open:r,defaultOpen:s,onOpenChange:o,modal:d=!0}=e,c=a.useRef(null),u=a.useRef(null),[f=!1,p]=(0,l.T)({prop:r,defaultProp:s,onChange:o});return(0,v.jsx)(w,{scope:t,triggerRef:c,contentRef:u,contentId:(0,i.M)(),titleId:(0,i.M)(),descriptionId:(0,i.M)(),open:f,onOpenChange:p,onOpenToggle:a.useCallback(()=>p(e=>!e),[p]),modal:d,children:n})};Dialog.displayName=y;var D="DialogTrigger",k=a.forwardRef((e,t)=>{let{__scopeDialog:n,...a}=e,o=N(D,n),i=(0,s.e)(t,o.triggerRef);return(0,v.jsx)(p.WV.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":getState(o.open),...a,ref:i,onClick:(0,r.M)(e.onClick,o.onOpenToggle)})});k.displayName=D;var C="DialogPortal",[E,S]=b(C,{forceMount:void 0}),DialogPortal=e=>{let{__scopeDialog:t,forceMount:n,children:r,container:s}=e,o=N(C,t);return(0,v.jsx)(E,{scope:t,forceMount:n,children:a.Children.map(r,e=>(0,v.jsx)(f.z,{present:n||o.open,children:(0,v.jsx)(u.h,{asChild:!0,container:s,children:e})}))})};DialogPortal.displayName=C;var T="DialogOverlay",R=a.forwardRef((e,t)=>{let n=S(T,e.__scopeDialog),{forceMount:a=n.forceMount,...r}=e,s=N(T,e.__scopeDialog);return s.modal?(0,v.jsx)(f.z,{present:a||s.open,children:(0,v.jsx)(I,{...r,ref:t})}):null});R.displayName=T;var I=a.forwardRef((e,t)=>{let{__scopeDialog:n,...a}=e,r=N(T,n);return(0,v.jsx)(h.Z,{as:x.g7,allowPinchZoom:!0,shards:[r.contentRef],children:(0,v.jsx)(p.WV.div,{"data-state":getState(r.open),...a,ref:t,style:{pointerEvents:"auto",...a.style}})})}),O="DialogContent",_=a.forwardRef((e,t)=>{let n=S(O,e.__scopeDialog),{forceMount:a=n.forceMount,...r}=e,s=N(O,e.__scopeDialog);return(0,v.jsx)(f.z,{present:a||s.open,children:s.modal?(0,v.jsx)(A,{...r,ref:t}):(0,v.jsx)(z,{...r,ref:t})})});_.displayName=O;var A=a.forwardRef((e,t)=>{let n=N(O,e.__scopeDialog),o=a.useRef(null),i=(0,s.e)(t,n.contentRef,o);return a.useEffect(()=>{let e=o.current;if(e)return(0,g.Ry)(e)},[]),(0,v.jsx)(M,{...e,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,r.M)(e.onCloseAutoFocus,e=>{e.preventDefault(),n.triggerRef.current?.focus()}),onPointerDownOutside:(0,r.M)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey,a=2===t.button||n;a&&e.preventDefault()}),onFocusOutside:(0,r.M)(e.onFocusOutside,e=>e.preventDefault())})}),z=a.forwardRef((e,t)=>{let n=N(O,e.__scopeDialog),r=a.useRef(!1),s=a.useRef(!1);return(0,v.jsx)(M,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(r.current||n.triggerRef.current?.focus(),t.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(r.current=!0,"pointerdown"!==t.detail.originalEvent.type||(s.current=!0));let a=t.target,o=n.triggerRef.current?.contains(a);o&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&s.current&&t.preventDefault()}})}),M=a.forwardRef((e,t)=>{let{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:i,...l}=e,u=N(O,n),f=a.useRef(null),p=(0,s.e)(t,f);return(0,m.EW)(),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(c.M,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:o,onUnmountAutoFocus:i,children:(0,v.jsx)(d.XB,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":getState(u.open),...l,ref:p,onDismiss:()=>u.onOpenChange(!1)})}),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(TitleWarning,{titleId:u.titleId}),(0,v.jsx)(DescriptionWarning,{contentRef:f,descriptionId:u.descriptionId})]})]})}),P="DialogTitle",V=a.forwardRef((e,t)=>{let{__scopeDialog:n,...a}=e,r=N(P,n);return(0,v.jsx)(p.WV.h2,{id:r.titleId,...a,ref:t})});V.displayName=P;var F="DialogDescription",Z=a.forwardRef((e,t)=>{let{__scopeDialog:n,...a}=e,r=N(F,n);return(0,v.jsx)(p.WV.p,{id:r.descriptionId,...a,ref:t})});Z.displayName=F;var W="DialogClose",L=a.forwardRef((e,t)=>{let{__scopeDialog:n,...a}=e,s=N(W,n);return(0,v.jsx)(p.WV.button,{type:"button",...a,ref:t,onClick:(0,r.M)(e.onClick,()=>s.onOpenChange(!1))})});function getState(e){return e?"open":"closed"}L.displayName=W;var H="DialogTitleWarning",[$,B]=(0,o.k)(H,{contentName:O,titleName:P,docsSlug:"dialog"}),TitleWarning=({titleId:e})=>{let t=B(H),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return a.useEffect(()=>{if(e){let t=document.getElementById(e);t||console.error(n)}},[n,e]),null},DescriptionWarning=({contentRef:e,descriptionId:t})=>{let n=B("DialogDescriptionWarning"),r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${n.contentName}}.`;return a.useEffect(()=>{let n=e.current?.getAttribute("aria-describedby");if(t&&n){let e=document.getElementById(t);e||console.warn(r)}},[r,e,t]),null},q=Dialog,Q=k,U=DialogPortal,X=R,Y=_,K=V,G=Z,J=L}},function(e){e.O(0,[371,899,691,213,121,290,744],function(){return e(e.s=5283)}),_N_E=e.O()}]);