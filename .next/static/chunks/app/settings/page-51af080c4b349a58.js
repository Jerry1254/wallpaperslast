(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{47645:function(e,t,a){Promise.resolve().then(a.bind(a,80703))},80703:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return SettingsPage}});var s=a(26705),n=a(20955),r=a(23611),o=a(35831),l=a(71271),i=a(49598),d=a(56731),c=a(28811),u=a.n(c);a(65368);let f=u()(()=>Promise.all([a.e(70),a.e(77),a.e(889)]).then(a.t.bind(a,6233,23)).then(e=>{let t=["header","bold","italic","underline","strike","color","background","align","clean"];return function(a){return(0,s.jsx)(e.default,{...a,formats:t})}}),{loadableGenerated:{webpack:()=>[6233]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"h-40 w-full animate-pulse bg-gray-100 rounded-lg"})});function QuillEditor(e){let{value:t,onChange:a}=e,[r,o]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{o(!0)},[]),r)?(0,s.jsx)(f,{theme:"snow",value:t,onChange:a,modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{align:[]}],["clean"]]}}):(0,s.jsx)("div",{className:"h-40 w-full animate-pulse bg-gray-100 rounded-lg"})}function SettingsContent(){let[e,t]=(0,n.useState)({share_header_text:"",share_button_text:""}),[a,d]=(0,n.useState)(!1),{toast:c}=(0,l.pm)();(0,n.useEffect)(()=>{fetchSettings()},[]);let fetchSettings=async()=>{try{let e=await fetch("/api/settings"),a=await e.json();0===a.code&&a.data&&t(a.data)}catch(e){c({variant:"destructive",description:"获取设置失败"})}},handleSave=async()=>{if(!e.share_header_text.trim()||!e.share_button_text.trim()){c({variant:"destructive",description:"所有字段都不能为空"});return}try{d(!0);let t=await fetch("/api/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await t.json();if(0===a.code)c({description:"保存成功"});else throw Error(a.message)}catch(e){c({variant:"destructive",description:"保存失败"})}finally{d(!1)}};return(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)(i.Zb,{children:[(0,s.jsxs)(i.Ol,{children:[(0,s.jsx)(i.ll,{children:"分享页设置"}),(0,s.jsx)(i.SZ,{children:"设置分享页面的显示内容和分享按钮文本"})]}),(0,s.jsxs)(i.aY,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"分享页描述"}),(0,s.jsx)(QuillEditor,{value:e.share_header_text,onChange:e=>t(t=>({...t,share_header_text:e}))})]}),(0,s.jsxs)("div",{className:"space-y-2 mt-16",children:[(0,s.jsx)("label",{className:"text-sm font-medium",children:"分享按钮文本"}),(0,s.jsx)(o.I,{value:e.share_button_text,onChange:e=>t(t=>({...t,share_button_text:e.target.value})),placeholder:"请输入分享按钮文本"}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["此文本将与分享链接拼接，例如：",e.share_button_text," http://example.com/share/123"]})]}),(0,s.jsx)(r.z,{onClick:handleSave,disabled:a,className:"w-full",children:a?"保存中...":"保存设置"})]})]})})}function SettingsPage(){return(0,s.jsx)(d.AdminLayout,{children:(0,s.jsx)(SettingsContent,{})})}},56731:function(e,t,a){"use strict";a.r(t),a.d(t,{AdminLayout:function(){return AdminLayout}});var s=a(26705),n=a(20955),r=a(68004),o=a(67972),l=a(65883),i=a(23611),d=a(23291),c=a(17158),u=a(62442),f=a(76369),m=a(81628);let p=d.fC,h=d.xz;d.ZA,d.Uv,d.Tr,d.Ee;let x=n.forwardRef((e,t)=>{let{className:a,inset:n,children:r,...o}=e;return(0,s.jsxs)(d.fF,{ref:t,className:(0,m.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",a),...o,children:[r,(0,s.jsx)(c.Z,{className:"ml-auto"})]})});x.displayName=d.fF.displayName;let g=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(d.tu,{ref:t,className:(0,m.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})});g.displayName=d.tu.displayName;let b=n.forwardRef((e,t)=>{let{className:a,sideOffset:n=4,...r}=e;return(0,s.jsx)(d.Uv,{children:(0,s.jsx)(d.VY,{ref:t,sideOffset:n,className:(0,m.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})})});b.displayName=d.VY.displayName;let v=n.forwardRef((e,t)=>{let{className:a,inset:n,...r}=e;return(0,s.jsx)(d.ck,{ref:t,className:(0,m.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",a),...r})});v.displayName=d.ck.displayName;let y=n.forwardRef((e,t)=>{let{className:a,children:n,checked:r,...o}=e;return(0,s.jsxs)(d.oC,{ref:t,className:(0,m.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:r,...o,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(d.wU,{children:(0,s.jsx)(u.Z,{className:"h-4 w-4"})})}),n]})});y.displayName=d.oC.displayName;let j=n.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,s.jsxs)(d.Rk,{ref:t,className:(0,m.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(d.wU,{children:(0,s.jsx)(f.Z,{className:"h-2 w-2 fill-current"})})}),n]})});j.displayName=d.Rk.displayName;let N=n.forwardRef((e,t)=>{let{className:a,inset:n,...r}=e;return(0,s.jsx)(d.__,{ref:t,className:(0,m.cn)("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",a),...r})});N.displayName=d.__.displayName;let _=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(d.Z0,{ref:t,className:(0,m.cn)("-mx-1 my-1 h-px bg-muted",a),...n})});_.displayName=d.Z0.displayName;var w=a(24033);function Header(e){let{onMenuClick:t}=e;return(0,w.useRouter)(),(0,s.jsx)("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,s.jsxs)("div",{className:"flex h-14 items-center px-4 gap-4",children:[(0,s.jsxs)(i.z,{variant:"ghost",size:"icon",onClick:t,className:"md:hidden",children:[(0,s.jsx)(r.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Toggle sidebar"})]}),(0,s.jsx)("div",{className:"flex items-center gap-0",children:(0,s.jsx)("span",{className:"font-semibold",children:"壁纸管理系统"})}),(0,s.jsx)("div",{className:"flex flex-1 items-center justify-end gap-4",children:(0,s.jsxs)(p,{children:[(0,s.jsx)(h,{asChild:!0,children:(0,s.jsxs)(i.z,{variant:"ghost",className:"gap-2",children:[(0,s.jsx)(o.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"吉意空间"}),(0,s.jsx)("span",{className:"sr-only",children:"User menu"})]})}),(0,s.jsxs)(b,{align:"end",children:[(0,s.jsx)(N,{children:"我的账户"}),(0,s.jsx)(_,{}),(0,s.jsxs)(v,{onClick:async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),localStorage.removeItem("user"),window.location.replace("/login")}catch(e){console.error("Logout failed:",e)}},children:[(0,s.jsx)(l.Z,{className:"mr-2 h-4 w-4"}),"退出登录"]})]})]})})]})})}var S=a(61396),O=a.n(S),T=a(25119),k=a(38438),C=a(25750),R=a(29409);let E=[{title:"仪表盘",icon:T.Z,href:"/dashboard"},{title:"壁纸管理",icon:k.Z,href:"/wallpapers"},{title:"用户管理",icon:C.Z,href:"/users"},{title:"分享页设置",icon:R.Z,href:"/settings"}];function Sidebar(e){let{isOpen:t}=e,a=(0,w.usePathname)();return(0,s.jsx)("aside",{className:(0,m.cn)("fixed left-0 top-14 z-30 h-[calc(100vh-3.5rem)] w-64 border-r bg-background transition-transform md:sticky",!t&&"-translate-x-full md:translate-x-0"),children:(0,s.jsx)("div",{className:"space-y-4 py-4",children:(0,s.jsx)("div",{className:"px-3 py-2",children:(0,s.jsx)("div",{className:"space-y-1",children:(0,s.jsx)("nav",{className:"space-y-1",children:E.map(e=>(0,s.jsxs)(O(),{href:e.href,className:(0,m.cn)("flex items-center rounded-lg px-3 py-2 text-sm font-medium hover:bg-accent hover:text-accent-foreground",a===e.href&&"bg-accent text-accent-foreground"),children:[(0,s.jsx)(e.icon,{className:"mr-2 h-4 w-4"}),e.title]},e.href))})})})})})}function AdminLayout(e){let{children:t}=e,[a,r]=(0,n.useState)(!0);return(0,s.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,s.jsx)(Header,{onMenuClick:()=>r(!a)}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(Sidebar,{isOpen:a}),(0,s.jsx)("main",{className:"flex-1 p-6",children:(0,s.jsx)("div",{className:"container mx-auto max-w-7xl",children:t})})]})]})}},23611:function(e,t,a){"use strict";a.d(t,{d:function(){return d},z:function(){return c}});var s=a(26705),n=a(20955),r=a(67256),o=a(96061),l=a(81628),i=a(63715);let d=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:a,variant:n,size:o,asChild:c=!1,loading:u=!1,children:f,disabled:m,...p}=e,h=c?r.g7:"button";return(0,s.jsx)(h,{className:(0,l.cn)(d({variant:n,size:o,className:a})),ref:t,disabled:u||m,...p,children:u?(0,s.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4 animate-spin"}),f]}):f})});c.displayName="Button"},49598:function(e,t,a){"use strict";a.d(t,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return o},aY:function(){return c},ll:function(){return i}});var s=a(26705),n=a(20955),r=a(81628);let o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...n})});o.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...n})});l.displayName="CardHeader";let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a),...n})});i.displayName="CardTitle";let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",a),...n})});d.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",a),...n})});c.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",a),...n})});u.displayName="CardFooter"},35831:function(e,t,a){"use strict";a.d(t,{I:function(){return o}});var s=a(26705),n=a(20955),r=a(81628);let o=n.forwardRef((e,t)=>{let{className:a,type:n,...o}=e;return(0,s.jsx)("input",{type:n,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...o})});o.displayName="Input"},71271:function(e,t,a){"use strict";a.d(t,{Am:function(){return toast},pm:function(){return useToast}});var s=a(20955);let n=0,r=new Map,addToRemoveQueue=e=>{if(r.has(e))return;let t=setTimeout(()=>{r.delete(e),dispatch({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,t)},reducer=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?addToRemoveQueue(a):e.toasts.forEach(e=>{addToRemoveQueue(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],l={toasts:[]};function dispatch(e){l=reducer(l,e),o.forEach(e=>{e(l)})}function toast(e){let{...t}=e,a=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),dismiss=()=>dispatch({type:"DISMISS_TOAST",toastId:a});return dispatch({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||dismiss()}}}),{id:a,dismiss,update:e=>dispatch({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function useToast(){let[e,t]=s.useState(l);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast,dismiss:e=>dispatch({type:"DISMISS_TOAST",toastId:e})}}},81628:function(e,t,a){"use strict";a.d(t,{cn:function(){return cn}});var s=a(57042),n=a(74769);function cn(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.m6)((0,s.W)(t))}},28811:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return dynamic}});let s=a(21024);a(20955);let n=s._(a(57075));function convertModule(e){return{default:(null==e?void 0:e.default)||e}}function dynamic(e,t){let a=n.default,s={loading:e=>{let{error:t,isLoading:a,pastDelay:s}=e;return null}};"function"==typeof e&&(s.loader=e),Object.assign(s,t);let r=s.loader;return a({...s,loader:()=>null!=r?r().then(convertModule):Promise.resolve(convertModule(()=>null))})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},19167:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{suspense:function(){return suspense},NoSSR:function(){return NoSSR}});let s=a(11283);function suspense(){let e=Error(s.NEXT_DYNAMIC_NO_SSR_CODE);throw e.digest=s.NEXT_DYNAMIC_NO_SSR_CODE,e}function NoSSR(e){let{children:t}=e;return t}},57075:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return _default}});let s=a(21024),n=s._(a(20955)),r=a(19167),_default=function(e){let t=Object.assign({loader:null,loading:null,ssr:!0},e);function LoadableComponent(e){let a=t.loading,s=n.default.createElement(a,{isLoading:!0,pastDelay:!0,error:null}),o=t.ssr?n.default.Fragment:r.NoSSR,l=t.lazy;return n.default.createElement(n.default.Suspense,{fallback:s},n.default.createElement(o,null,n.default.createElement(l,e)))}return t.lazy=n.default.lazy(t.loader),LoadableComponent.displayName="LoadableComponent",LoadableComponent}},65368:function(){}},function(e){e.O(0,[371,899,705,839,121,290,744],function(){return e(e.s=47645)}),_N_E=e.O()}]);